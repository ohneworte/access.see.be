/* access.see.be - Accessibility-Library for Prototype, www.access-see-be.net, Version 0.5
 * Copyright (C) 2008  diamonddogs web consulting gesmbh, www.diamonddogs.cc
 *  
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 *  
 * Component: ariaNamespaces.js
 * Adaption of <http://www.w3.org/WAI/PF/adaptable/HTML4/embedding-20061212.html>
 *
 *--------------------------------------------------------------------------*/

var NS_STATE="http://www.w3.org/2005/07/aaa";var NS_MAPPING=$A();NS_MAPPING["http://www.w3.org/2005/07/aaa"]="aaa:";function initApp(B){if(document.isInitialized){return }document.isInitialized=true;if((!B)||(!B.getElementsByTagName)){B=$$("body").first()}initWidgets();new AriaMyFunction("application")}function initWidgets(){var D=$$("body").first();var F=$A();var E=$$(".access-see-be");E.each(function(C){var a=C.className;$(C).removeClassName("access-see-be");var W=new String();var c=new Object();var U=C.getElementsAttributes(new Array("class","style"));switch(a.split(" ")[1]){case"aCheckbox":var Z={format:Aria.supports.flash?"swf":"gif",width:30,height:30,wrap:true,removeFurtherElements:true};Object.parseSettings(c,Z,U);c.insert=C.identify();W=D.getElementsByAttribute("for",C.identify()).first()?D.getElementsByAttribute("for",C.identify()).first().innerHTML:"No Label found! Use a <label>-Tag next to your Radio-Button";new AriaCheckbox(W,U,c);$(D.getElementsByAttribute("for",C.identify()).first().identify()).remove();$(C).hide();c.removeFurtherElements.toString().include("true")?$(C).removeFurtherElements():null;break;case"aRadio":var Z={format:Aria.supports.flash?"swf":"gif",width:30,height:30,wrap:true};var A=$A();var T=$(D.getElementsByAttribute("name",C.name));T.each(function(I){var H=I.getElementsAttributes(new Array("class","style"));var G=new Object();Object.parseSettings(G,Z,I);G.insert=I.identify();W=D.getElementsByAttribute("for",I.identify()).first()?D.getElementsByAttribute("for",I.identify()).first().innerHTML:"No Label found! Use a <label>-Tag next to your Radio-Button";A.push([W,H,G]);$(D.getElementsByAttribute("for",I.identify()).first().identify()).remove();$(I).removeClassName("aRadio").hide();if(T.indexOf($(I)).succ()<T.size()){$(I).removeFurtherElements()}}.bind(this));new AriaRadioGroup(A);break;case"aTablist":var Z={buttons:false,focus:true};var Y={active:false,disabled:false};Object.parseSettings(c,Z,U);c.insert=C.identify();var X=$A();$(C).childElements().each(function(H){var G=H.getElementsAttributes(new Array("class","style"));var I=new Object();Object.parseSettings(I,Y,G);X.push([H.innerHTML,G,I])}.bind(this));new AriaTablist(X,U,c);$(C.id).remove();break;case"aListbox":var Z={position:"right",wrap:true};var b={};Object.parseSettings(c,Z,U);c.insert=C.identify();c.indent=$$("#"+C.identify()+" option").indexOf($(C).getElementsByAttribute("selected","true").first());c.optgroups=$A();$(C).descendants().each(function(G){if(G.tagName.toLowerCase().include("optgroup")){var I=$(C).descendants().indexOf(G);var H=G.getElementsAttributes(new Array("label"));c.optgroups.push([H.label,I])}}.bind(this));var V=$A();$$("#"+C.identify()+" option").each(function(G){var I=G.getElementsAttributes(new Array("class","style"));var H=new Object();Object.parseSettings(H,b,I);V.push([G.innerHTML,I,H])}.bind(this));new AriaListbox(V,U,c);$(C).hide();break;case"aTree":var Z={format:Aria.supports.flash?"swf":"gif",width:10,height:10};var S={children:0,wrap:true};Object.parseSettings(c,Z,U);c.insert=C.identify();var B=$A();$$("#"+C.identify()+" tbody").first().childElements().each(function(G){var H=G.getElementsAttributes(new Array("class","style"));var I=new Object();Object.parseSettings(I,S,H);B.push([G.innerHTML.stripTags().strip(),H,I])}.bind(this));new AriaTree(B,U,c);$(C.id).remove();break;case"aSlider":var Z={width:10,height:17,size:false,buttons:false,wrap:true};Object.parseSettings(c,Z,U);c.values=$A();$(C).descendants().each(function(G){c.values.push(parseInt(G.innerHTML))});c.min=parseInt($(C).firstDescendant().value);c.max=parseInt($(C).descendants()[($(C).descendants().size()).decc()].value);c.increment=parseInt($(C).descendants()[1].innerHTML-$(C).descendants().first().value);c.incrementStep=c.max/2;c.indent=parseInt($(C).getElementsByAttribute("selected","true").first().value);c.insert=C.identify();new AriaSlider(U,c);C.hide();break;case"aButton":C.readAttribute("value")?W=C.readAttribute("value"):W="No Label found! Use a value-Attribute in your Input-Field";var d=new Object();d.path=C.readAttribute("onclick")?C.readAttribute("onclick"):null;d.insert=C.identify();new AriaButton(W,U,d);$(C.identify()).remove();break;case"aTextbox":D.getElementsByAttribute("for",C.identify()).first()?W=D.getElementsByAttribute("for",C.identify()).first().innerHTML:W="No Label found! Use a <label>-Tag next to your Text-Field";new AriaTextbox(W,U,{insert:C.identify()});$(D.getElementsByAttribute("for",C.identify()).first().identify()).remove();$(C.identify()).remove();break;case"aMenu":$(C).descendants(1).each(function(G){F.push([G.innerHTML,{"class":G.className},{insert:C.identify()}])}.bind(this));new AriaMenu(F,U);$(C.id).remove();break}}.bind(this))}function initContent(F){if(F.className.include(Aria.delimiter)){setRolesAndStates(F)}if(document.evaluate){var H=document.evaluate('.//*[contains(@class,"'+Aria.delimiter+' ")]',F,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var G=H.snapshotLength-1;G>=0;G--){setRolesAndStates(H.snapshotItem(G))}}else{var E=!Object.isUndefined(F.all)?F.all:F.getElementsByTagName("*");for(var G=0;G<E.length;G++){if(E[G].className.include(Aria.delimiter)){setRolesAndStates(E[G])}}}}function setRolesAndStates(J){var I=0;var O=1;var M=2;var K=J.className;var P=K.split(" ");var N=I;var L="";P.each(function(C){var A=C.strip();if(!A){return }if(A==Aria.delimiter){N=O}else{if(N==O){J.setAttribute("role",(Aria.supports.ff[3]?new String():"wairole:")+A);N=M;L=A}else{if(N==M){if(A.include("-")){var B=A.split("-");setARIAState(J,NS_STATE,B.first(),B[1])}else{setARIAState(J,NS_STATE,A,"true")}}}}})}function setARIAState(F,G,E,H){if(Aria.supports.ie||Aria.supports.opera){F.setAttribute("aria-"+E,H)}else{if(!Object.isUndefined(document.documentElement.setAttributeNS)){F.setAttributeNS(G,E,H)}else{F.setAttribute(NS_MAPPING[G]+E,H)}}}function getARIAState(E,F,D){if(Aria.supports.ie||Aria.supports.opera){return E.getAttribute("aria-"+D)}else{if(!Object.isUndefined(document.documentElement.getAttributeNS)){return E.getAttributeNS(F,D)}else{return E.getAttribute(NS_MAPPING[F]+D)}}}window.onload=initApp;if(document.addEventListener){document.addEventListener("DOMContentLoaded",initApp,false)};